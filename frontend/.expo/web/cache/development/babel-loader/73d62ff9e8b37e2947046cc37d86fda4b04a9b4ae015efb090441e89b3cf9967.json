{"ast":null,"code":"import AsyncStorage from '@react-native-async-storage/async-storage';\nimport { LOGIN_USER, GET_ERRORS } from \"../constants/user\";\nimport axios from \"axios\";\nimport setAuthToken from \"../setAuthToken\";\nimport jwtDecode from \"jwt-decode\";\nimport { SERVER } from \"../constants/config\";\nexport const checkPhoneNumber = (phone, callback) => {\n  const headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    Authorization: AsyncStorage.getItem(\"jwtToken\"),\n    fingerprint: \"123456\",\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE'\n  };\n  const params = {\n    phone\n  };\n  return dispatch => {\n    axios.get(`${SERVER}/coffee/phone/check`, {\n      headers: headers,\n      params: params\n    }).then(res => {\n      callback(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const requestLoginUSer = userData => {\n  const params = {\n    username: userData.username,\n    password: userData.password,\n    fingerprint: userData.fingerprint\n  };\n  const headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    Authorization: AsyncStorage.getItem(\"jwtToken\"),\n    fingerprint: \"123456\",\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE'\n  };\n  return dispatch => {\n    axios.get(`${SERVER}/coffee/login`, {\n      headers: headers,\n      params: params\n    }).then(res => {\n      console.log(res.data.detail);\n      if (typeof res.data.detail !== \"string\") {\n        const {\n          token\n        } = res.data.detail;\n        AsyncStorage.setItem(\"jwtToken\", token);\n        AsyncStorage.setItem(\"userLogin\", JSON.stringify(res.data.detail));\n        setAuthToken(token);\n        const decoded = jwtDecode(token);\n        dispatch(actLoginUser(decoded));\n      } else {\n        alert(\"Tài khoản hoặc mật khẩu sai gòi.\");\n      }\n    }).catch(err => {\n      console.log(err.response.data.detail);\n      dispatch({\n        type: GET_ERRORS,\n        payload: err.response.data.detail\n      });\n    });\n  };\n};\nexport const registerUser = (username, fullname, callback) => {\n  console.log('username', username);\n  console.log('fullname', fullname);\n  const headers = {\n    \"Content-Type\": \"application/x-www-form-urlencoded\",\n    Authorization: AsyncStorage.getItem(\"jwtToken\"),\n    fingerprint: \"123456\",\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE'\n  };\n  return dispatch => {\n    axios.post(`${SERVER}/coffee/register`, {\n      username: username,\n      fullname: fullname,\n      fingerprint: '123456'\n    }).then(res => {\n      callback(res.data);\n    }).catch(err => {\n      dispatch({\n        type: GET_ERRORS,\n        payload: err.response.data\n      });\n    });\n  };\n};","map":{"version":3,"names":["AsyncStorage","LOGIN_USER","GET_ERRORS","axios","setAuthToken","jwtDecode","SERVER","checkPhoneNumber","phone","callback","headers","Authorization","getItem","fingerprint","params","dispatch","get","then","res","data","catch","err","console","log","requestLoginUSer","userData","username","password","detail","token","setItem","JSON","stringify","decoded","actLoginUser","alert","response","type","payload","registerUser","fullname","post"],"sources":["/home/data2/AIFace/AICoffeeLeaf/frontend/store/actions/user.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\nimport { LOGIN_USER, GET_ERRORS } from \"../constants/user\";\nimport axios from \"axios\";\nimport setAuthToken from \"../setAuthToken\";\nimport jwtDecode from \"jwt-decode\";\nimport {SERVER} from \"../constants/config\";\n\nexport const checkPhoneNumber = (phone, callback) => {\n    const headers = {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: AsyncStorage.getItem(\"jwtToken\"),\n        fingerprint: \"123456\",\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE',\n    };\n\n    const params = { phone }\n\n    return dispatch => {\n        axios\n            .get(`${SERVER}/coffee/phone/check`, {\n                headers: headers,\n                params: params\n            })\n            .then(res => {\n                callback(res.data)\n            })\n            .catch(err => {\n                console.log(err)\n            })\n    }\n\n\n\n\n}\n\nexport const requestLoginUSer = userData => {\n    // console.log(userData)\n    const params = {\n        username: userData.username,\n        password: userData.password,\n        fingerprint: userData.fingerprint\n    }\n\n    const headers = {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: AsyncStorage.getItem(\"jwtToken\"),\n        fingerprint: \"123456\",\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE',\n    };\n\n    return dispatch => {\n        axios\n            .get(`${SERVER}/coffee/login`, {\n                headers: headers,\n                params: params\n            })\n            .then(res => {\n                console.log(res.data.detail)\n                // console.log(res.data.detail)\n                if (typeof res.data.detail !== \"string\") {\n                    const { token } = res.data.detail;\n                    AsyncStorage.setItem(\"jwtToken\", token);\n                    AsyncStorage.setItem(\"userLogin\", JSON.stringify(res.data.detail));\n                    // console.log('set Item Ok')\n                    setAuthToken(token);\n                    // console.log('set Token Ok')\n                    const decoded = jwtDecode(token);\n                    // console.log(decoded)\n                    dispatch(actLoginUser(decoded));\n                    // console.log('decoded Ok')\n                    //   callback();\n                } else {\n                    alert(\"Tài khoản hoặc mật khẩu sai gòi.\");\n                }\n            })\n            .catch(err => {\n                console.log(err.response.data.detail)\n                dispatch({\n                    type: GET_ERRORS,\n                    payload: err.response.data.detail\n                });\n            });\n    };\n};\n\nexport const registerUser = (username, fullname, callback) => {\n\n    console.log('username', username)\n    console.log('fullname', fullname)\n\n    const headers = {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: AsyncStorage.getItem(\"jwtToken\"),\n        fingerprint: \"123456\",\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE',\n    };\n\n    // console.log(params)\n\n    return dispatch => {\n        axios\n            .post(\n                `${SERVER}/coffee/register`,\n                // formData,\n                {\n                    username: username,\n                    fullname: fullname,\n                    fingerprint: '123456'\n                }\n            )\n            .then(res => {\n                callback(res.data);\n                // console.log(large)\n                // history.push(\"/\");\n                // return <Redirect to='/users' />\n            })\n            .catch(err => {\n                // console.log(err)\n                dispatch({\n                    type: GET_ERRORS,\n                    payload: err.response.data\n                });\n            });\n    };\n};"],"mappings":"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"},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}